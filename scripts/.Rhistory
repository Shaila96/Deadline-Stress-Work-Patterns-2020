knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(grid)
library(gridExtra)
library(dplyr)
library(ggpubr)
#install.packages('DataCombine')
library(DataCombine)
library(dplyr)
library(reshape2)
library(tidyr)
library(stringr)
library(plyr)
library(ggplot2)
library(dplyr)
library(miceadds)
library(gtools)
library(ggpubr)
library(gvlma)
library(MASS)
library(reshape2)
library(ggcorrplot)
library(GGally)
library(ggnewscale)
library(scales)
library(cowplot)
library(tidyverse)  # data manipulation
library(cluster)    # clustering algorithms
library(factoextra)
library(dendextend)
Cluster_DF$Trait_anxiety<- DF_Bib$Trait_anxiety
current_dir <- getwd()
setwd('..')
root_dir <- getwd()
data_dir <- file.path(root_dir, 'curated-data/physiological-data')
#data_file_name<-'qc99_all_subj.csv'
#data_file_name<-'qc1_treatment_mean_v1.csv'
data_file_name<-'qc1_log_trans_mean_v1.csv'
Main_DF<-read.csv(file.path(data_dir,data_file_name),stringsAsFactors = FALSE)
Main_DF<-subset(Main_DF, select = -c(E4_EDA,iWatch_HR ))
Cluster_DF <- data.frame(matrix(ncol = 9, nrow = 9))
x <- c("Participant_ID", "Day1_PP", "Day2_PP", "Day3_PP", "Day4_PP","Day1_HR","Day2_HR", "Day3_HR", "Day4_HR")
colnames(Cluster_DF) <- x
Cluster_DF$Participant_ID<-levels(factor(Main_DF$Participant_ID))
rownames(Cluster_DF)<-Cluster_DF$Participant_ID
Cluster_DF$Participant_ID<-NULL
Day_No<-factor(Main_DF$Day)
numberOfDay=nlevels(Day_No)
for (j in 1:numberOfDay) {
#Cluster_DF_RB<-subset(Main_DF, Day==levels(Day_No)[j] & Main_DF$Treatment=="RB")
Cluster_DF_WS<-subset(Main_DF, Day==levels(Day_No)[j] & Main_DF$Treatment=="WS")
#Cluster_DF[j]<- Cluster_DF_WS$PP - Cluster_DF_RB$PP
Cluster_DF[j]<- Cluster_DF_WS$PP
#Cluster_DF[j+1]<- Cluster_DF_WS$E4_HR - Cluster_DF_RB$E4_HR
}
for (j in 1:numberOfDay) {
#Cluster_DF_RB<-subset(Main_DF, Day==levels(Day_No)[j] & Main_DF$Treatment=="RB")
Cluster_DF_WS<-subset(Main_DF, Day==levels(Day_No)[j] & Main_DF$Treatment=="WS")
#Cluster_DF[j]<- Cluster_DF_WS$PP - Cluster_DF_RB$PP
#Cluster_DF[j+4]<- Cluster_DF_WS$E4_HR - Cluster_DF_RB$E4_HR
Cluster_DF[j+4]<- Cluster_DF_WS$E4_HR
}
Cluster_DF[is.na(Cluster_DF)] <- 0
#Cluster_DF
DF_Bib<-read.csv("C:/Users/soton/Documents/R/DeadlineProject/Questionnaire/@CustomBiographic/Questionnaire Data.csv")
Cluster_DF$Trait_anxiety<- DF_Bib$Trait_anxiety
#Cluster_DF$Personality<- DF_Bib$Personality_AB
set.seed(123)
final <- kmeans(Cluster_DF, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = Cluster_DF)+ggtitle("Cluster using PP-HR-Trait Anxiety k = 2")+ xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
d <- dist(Cluster_DF, method = "euclidean")
hc5 <- hclust(d, method = "ward.D2" )
# Cut tree into 4 groups
sub_grp <- cutree(hc5, k = 2)
# Number of members in each cluster
#table(sub_grp)
plot(hc5, cex = 0.6, hang = -1, sub = "", xlab = "")
Cluster_DF$Trait_anxiety<-NULL
Cluster_DF$Agreeableness<- DF_Bib$BFI_.Agreeableness
Cluster_DF$Conscientiousness<- DF_Bib$BFI_.Conscientiousness
Cluster_DF$Extraversion<- DF_Bib$BFI_.Extraversion
Cluster_DF$Neuroticism<- DF_Bib$BFI_.Neuroticism
Cluster_DF$Openness<- DF_Bib$BFI_.Openness
set.seed(123)
final <- kmeans(Cluster_DF, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = Cluster_DF)+ggtitle("Cluster using PP-HR-BFI k = 2")+ xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
d <- dist(Cluster_DF, method = "euclidean")
hc5 <- hclust(d, method = "ward.D2" )
# Cut tree into 4 groups
sub_grp <- cutree(hc5, k = 2)
# Number of members in each cluster
#table(sub_grp)
plot(hc5, cex = 0.6, hang = -1, xlab = "", sub = "")
Cluster_DF$Trait_anxiety<- DF_Bib$Trait_anxiety
set.seed(123)
final <- kmeans(Cluster_DF, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = Cluster_DF)+ggtitle("Cluster using PP-Trait-BFI; k = 2")+ xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
d <- dist(Cluster_DF, method = "euclidean")
hc5 <- hclust(d, method = "ward.D2" )
# Cut tree into 4 groups
sub_grp <- cutree(hc5, k = 2)
# Number of members in each cluster
#table(sub_grp)
plot(hc5, cex = 0.6, hang = -1, xlab = "", sub = "")
current_dir <- getwd()
setwd('..')
root_dir <- getwd()
data_dir <- file.path(root_dir, 'curated-data/physiological-data')
#data_file_name<-'qc99_all_subj.csv'
data_file_name<-'Activity_Data.csv'
Activity_Data_all<-read.csv(file.path(data_dir,data_file_name),stringsAsFactors = FALSE)
Questionnaire_Data<-read.csv("C:/Users/soton/Documents/R/DeadlineProject/Questionnaire/@EndDay/Data/EndDaySurveyWithResult.csv",stringsAsFactors = FALSE)
Activity_Data_all$Mental<-Questionnaire_Data$Mentally
Activity_Data_all$Physically<-Questionnaire_Data$Physically
Activity_Data_all$Hurried<-Questionnaire_Data$Hurried
Activity_Data_all$Successful<-Questionnaire_Data$Successful
Activity_Data_all$Hard<-Questionnaire_Data$How_Hard
Activity_Data_all$Insecure<-Questionnaire_Data$Insecure
Activity_Data_Day1<-subset(Activity_Data_all, Day=="Day1")
Activity_Data_Day1$PP<- Cluster_DF$Day1_PP
Activity_Data_Day1$HR<- Cluster_DF$Day1_HR
rownames(Activity_Data_Day1)<-Activity_Data_Day1$Participant_ID
Activity_Data_Day1$Participant_ID<-NULL
Activity_Data_Day1$Day<-NULL
colnames(Activity_Data_Day1)<-c("Day1_R", "Day1_W", "Day1_Out", "Day1_SA", "Day1_SP", "Day1_I", "Day1_Mental", "Day1_Physical", "Day1_Hurried", "Day1_Successful", "Day1_Hard", "Day1_Insecure", "Day1_PP", "Day1_HR")
set.seed(123)
final <- kmeans(Activity_Data_Day1, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = Activity_Data_Day1)+ggtitle("Cluster Day1 using Activity-PP-HR k = 2")+ xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
d <- dist(Activity_Data_Day1, method = "euclidean")
hc5 <- hclust(d, method = "ward.D2" )
# Cut tree into 4 groups
sub_grp <- cutree(hc5, k = 2)
# Number of members in each cluster
#table(sub_grp)
plot(hc5, cex = 0.6, hang = -1, sub = "", xlab = "")
Activity_Data_Day2<-subset(Activity_Data_all, Day=="Day2")
Activity_Data_Day2$PP<- Cluster_DF$Day2_PP
Activity_Data_Day2$HR<- Cluster_DF$Day2_HR
rownames(Activity_Data_Day2)<-Activity_Data_Day2$Participant_ID
Activity_Data_Day2$Participant_ID<-NULL
Activity_Data_Day2$Day<-NULL
colnames(Activity_Data_Day2)<-c("Day2_R", "Day2_W", "Day2_Out", "Day2_SA", "Day2_SP", "Day2_I", "Day2_Mental", "Day2_Physical", "Day2_Hurried", "Day2_Successful", "Day2_Hard", "Day2_Insecure", "Day2_PP", "Day2_HR")
Activity_Data_Day2$Day2_SA<-NULL
set.seed(123)
final <- kmeans(Activity_Data_Day2, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = Activity_Data_Day2)+ggtitle("Cluster Day2 using Activity-PP-HR k = 2")+ xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
d <- dist(Activity_Data_Day2, method = "euclidean")
hc5 <- hclust(d, method = "ward.D2" )
# Cut tree into 4 groups
sub_grp <- cutree(hc5, k = 2)
# Number of members in each cluster
#table(sub_grp)
plot(hc5, cex = 0.6, hang = -1, sub = "", xlab = "")
set.seed(123)
final <- kmeans(Activity_Data_Day3, 2, nstart = 25)
Activity_Data_Day3<-subset(Activity_Data_all, Day=="Day3")
Activity_Data_Day3$PP<- Cluster_DF$Day3_PP
Activity_Data_Day3$HR<- Cluster_DF$Day3_HR
rownames(Activity_Data_Day3)<-Activity_Data_Day3$Participant_ID
Activity_Data_Day3$Participant_ID<-NULL
Activity_Data_Day3$Day<-NULL
#Activity_Data_Day2$SA<-NULL
colnames(Activity_Data_Day3)<-c("Day3_R", "Day3_W", "Day3_Out", "Day3_SA", "Day3_SP", "Day3_I", "Day3_Mental", "Day3_Physical", "Day3_Hurried", "Day3_Successful", "Day3_Hard", "Day3_Insecure", "Day3_PP", "Day3_HR")
set.seed(123)
final <- kmeans(Activity_Data_Day3, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = Activity_Data_Day3)+ggtitle("Cluster Day3 using Activity-PP-HR k = 2")+ xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
d <- dist(Activity_Data_Day3, method = "euclidean")
hc5 <- hclust(d, method = "ward.D2" )
# Cut tree into 4 groups
sub_grp <- cutree(hc5, k = 2)
# Number of members in each cluster
#table(sub_grp)
plot(hc5, cex = 0.6, hang = -1, sub = "", xlab = "")
Activity_Data_Day4<-subset(Activity_Data_all, Day=="Day4")
Activity_Data_Day4$PP<- Cluster_DF$Day4_PP
Activity_Data_Day4$HR<- Cluster_DF$Day4_HR
rownames(Activity_Data_Day4)<-Activity_Data_Day4$Participant_ID
Activity_Data_Day4$Participant_ID<-NULL
Activity_Data_Day4$Day<-NULL
colnames(Activity_Data_Day4)<-c("Day4_R", "Day4_W", "Day4_Out", "Day4_SA", "Day4_SP", "Day4_I", "Day4_Mental", "Day4_Physical", "Day4_Hurried", "Day4_Successful", "Day4_Hard", "Day4_Insecure", "Day4_PP", "Day4_HR")
Activity_Data_Day4$Day4_I<-NULL
Activity_Data_Day4<-subset(Activity_Data_all, Day=="Day4")
Activity_Data_Day4$PP<- Cluster_DF$Day4_PP
Activity_Data_Day4$HR<- Cluster_DF$Day4_HR
rownames(Activity_Data_Day4)<-Activity_Data_Day4$Participant_ID
Activity_Data_Day4$Participant_ID<-NULL
Activity_Data_Day4$Day<-NULL
colnames(Activity_Data_Day4)<-c("Day4_R", "Day4_W", "Day4_Out", "Day4_SA", "Day4_SP", "Day4_I", "Day4_Mental", "Day4_Physical", "Day4_Hurried", "Day4_Successful", "Day4_Hard", "Day4_Insecure", "Day4_PP", "Day4_HR")
Activity_Data_Day4$Day4_I<-NULL
set.seed(123)
final <- kmeans(Activity_Data_Day4, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = Activity_Data_Day4)+ggtitle("Cluster Day4 using Activity-PP-HR k = 2")+ xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
d <- dist(Activity_Data_Day4, method = "euclidean")
hc5 <- hclust(d, method = "ward.D2" )
# Cut tree into 4 groups
sub_grp <- cutree(hc5, k = 2)
# Number of members in each cluster
#table(sub_grp)
plot(hc5, cex = 0.6, hang = -1, xlab = "", sub = "")
set.seed(123)
final <- kmeans(all_data, 2, nstart = 25)
all_data<-cbind(Activity_Data_Day1, Activity_Data_Day2, Activity_Data_Day3, Activity_Data_Day4)
all_data$Trait_anxiety<-DF_Bib$Trait_anxiety
all_data$Agreeableness<- DF_Bib$BFI_.Agreeableness
all_data$Conscientiousness<- DF_Bib$BFI_.Conscientiousness
all_data$Extraversion<- DF_Bib$BFI_.Extraversion
all_data$Neuroticism<- DF_Bib$BFI_.Neuroticism
all_data$Openness<- DF_Bib$BFI_.Openness
set.seed(123)
final <- kmeans(all_data, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = all_data)+ggtitle("Clustering All the Day with Physiological, Activity, and PhychometricData") + xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
distMatrix <- dist(all_data, method="euclidean")
hc <- hclust(distMatrix, method="corr")
set.seed(123)
final <- kmeans(all_data, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = all_data)+ggtitle("Clustering All the Day with Physiological, Activity, and PhychometricData") + xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
distMatrix <- dist(all_data, method="euclidean")
hc <- hcluster(distMatrix, method="corr")
Activity_Data_Day4<-subset(Activity_Data_all, Day=="Day4")
Activity_Data_Day4$PP<- Cluster_DF$Day4_PP
Activity_Data_Day4$HR<- Cluster_DF$Day4_HR
rownames(Activity_Data_Day4)<-Activity_Data_Day4$Participant_ID
Activity_Data_Day4$Participant_ID<-NULL
Activity_Data_Day4$Day<-NULL
colnames(Activity_Data_Day4)<-c("Day4_R", "Day4_W", "Day4_Out", "Day4_SA", "Day4_SP", "Day4_I", "Day4_Mental", "Day4_Physical", "Day4_Hurried", "Day4_Successful", "Day4_Hard", "Day4_Insecure", "Day4_PP", "Day4_HR")
Activity_Data_Day4$Day4_I<-NULL
set.seed(123)
final <- kmeans(Activity_Data_Day4, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = Activity_Data_Day4)+ggtitle("Cluster Day4 using Activity-PP-HR k = 2")+ xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
d <- dist(Activity_Data_Day4, method = "euclidean")
hc5 <- hclust(d, method = "ward.D2" )
# Cut tree into 4 groups
sub_grp <- cutree(hc5, k = 3)
# Number of members in each cluster
#table(sub_grp)
plot(hc5, cex = 0.6, hang = -1, xlab = "", sub = "")
set.seed(123)
final <- kmeans(Activity_Data_Day4, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = Activity_Data_Day4)+ggtitle("Cluster Day4 using Activity-PP-HR k = 2")+ xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
d <- dist(Activity_Data_Day4, method = "euclidean")
hc5 <- hclust(d, method = "ward.D2" )
# Cut tree into 4 groups
sub_grp <- cutree(hc5, k = 2)
# Number of members in each cluster
#table(sub_grp)
plot(hc5, cex = 0.6, hang = -1, xlab = "", sub = "")
set.seed(123)
final <- kmeans(all_data, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = all_data)+ggtitle("Clustering All the Day with Physiological, Activity, and PhychometricData") + xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
distMatrix <- dist(all_data, method="euclidean")
hc <- hclust(distMatrix, method="ward.D2")
plot(hc, cex = 0.6, hang = -1, xlab = "", sub = "", main = "Clustering Dendogram")
set.seed(123)
final <- kmeans(all_data, 2, nstart = 25)
#print(final)
fviz_cluster(final, data = all_data)+ggtitle("Clustering All the Day with Physiological, Activity, and PhychometricData") + xlab("") + ylab("")+theme(plot.title = element_text(hjust = 0.5))
distMatrix <- dist(all_data, method="euclidean")
hc <- hclust(distMatrix, method="complete")
plot(hc, cex = 0.6, hang = -1, xlab = "", sub = "", main = "Clustering Dendogram")
all_data
View(all_data)
all_data<-cbind(Activity_Data_Day1, Activity_Data_Day2, Activity_Data_Day3, Activity_Data_Day4)
all_data<-cbind(Activity_Data_Day1, Activity_Data_Day2, Activity_Data_Day3, Activity_Data_Day4)
all_data$Trait_anxiety<-DF_Bib$Trait_anxiety
all_data$Agreeableness<- DF_Bib$BFI_.Agreeableness
all_data$Conscientiousness<- DF_Bib$BFI_.Conscientiousness
all_data$Extraversion<- DF_Bib$BFI_.Extraversion
all_data$Neuroticism<- DF_Bib$BFI_.Neuroticism
all_data$Openness<- DF_Bib$BFI_.Openness
